name: Dynamic Environment Deployment

run-name: Deploy ${{ github.event.inputs.environment }}

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Environment to deploy'
        required: true
        type: string
      app_version_id:
        description: 'The app version id'
        required: true
        type: string
      app_id:
        description: 'The app version id'
        required: true
        type: string

concurrency:
  group: deploy-${{ github.event.inputs.environment }}
  cancel-in-progress: false

jobs:
  deploy-canada:
    name: ðŸš€ Deploy to td-ca-1
    runs-on: ubuntu-latest
    environment: ${{ github.event.inputs.environment }}
    steps:
      - name: Example Step Canada
        run: echo "Deploying ${{ inputs.environment }} environment"
      - name: Sleep 5 minutes
        run: sleep 300
      - name: The End
        run: echo "Ended"

  deploy-europe:
    name: ðŸš€ Deploy to td-eu-1
    runs-on: ubuntu-latest
    needs: deploy-canada
    environment: ${{ github.event.inputs.environment }}
    steps:
      - name: Example Step Europe
        run: echo "Deploying ${{ inputs.environment }} environment"
      - name: Sleep 5 minutes
        run: sleep 300
      - name: The End
        run: echo "Ended"

  deploy-us:
    name: ðŸš€ Deploy to td-us-1
    runs-on: ubuntu-latest
    needs: deploy-europe
    environment: ${{ github.event.inputs.environment }}
    steps:
      - name: Example Step US
        run: echo "Deploying ${{ inputs.environment }} environment"
      - name: Sleep 5 minutes
        run: sleep 300
      - name: The End
        run: echo "Ended"
